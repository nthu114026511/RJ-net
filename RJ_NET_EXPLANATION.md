# RJ-Net: Reaction-Jacobian Network ç¨‹å¼èªªæ˜Žæ–‡æª”

## ðŸ“Œ ç›®éŒ„
1. [ç³»çµ±æ¦‚è¿°](#ç³»çµ±æ¦‚è¿°)
2. [ç‰©ç†æ–¹ç¨‹](#ç‰©ç†æ–¹ç¨‹)
3. [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
4. [ç¥žç¶“ç¶²è·¯æž¶æ§‹](#ç¥žç¶“ç¶²è·¯æž¶æ§‹)
5. [è¨“ç·´æµç¨‹](#è¨“ç·´æµç¨‹)
6. [è©•ä¼°éŽç¨‹](#è©•ä¼°éŽç¨‹)
7. [ä»£ç¢¼çµæ§‹](#ä»£ç¢¼çµæ§‹)

---

## ðŸŽ¯ ç³»çµ±æ¦‚è¿°

RJ-Net æ˜¯ä¸€å€‹ **Physics-Informed Neural Network (PINN)**ï¼Œç”¨ä¾†æ±‚è§£åŒ…å« **æµå‹• (Advection) å’Œ åæ‡‰ (Reaction)** çš„æ“´æ•£-åæ‡‰ç³»çµ±ã€‚

### æ ¸å¿ƒç‰¹é»ž
- âœ… å…©å€‹ç¨ç«‹çš„ç¥žç¶“ç¶²è·¯åŒæ™‚å­¸ç¿’é€Ÿåº¦å ´å’Œåæ‡‰å‹•åŠ›å­¸
- âœ… ä½¿ç”¨ Lagrangian æè¿°è¿½è¹¤åº§æ¨™è®Šæ› (Jacobian)
- âœ… ç‰©ç†ç´„æŸé€šéŽ PDE æ®˜å·®æå¤±å¼·åˆ¶
- âœ… æœ‰é™å·®åˆ†è¨ˆç®—ç©ºé–“å°Žæ•¸ï¼Œè¨ˆç®—é«˜æ•ˆç©©å®š

---

## ðŸ“ ç‰©ç†æ–¹ç¨‹

### ðŸ”´ å®Œæ•´çš„ä¸»æŽ§æ–¹ç¨‹ï¼ˆä¸€èˆ¬å½¢å¼ï¼‰

$$\rho_t + \nabla \cdot (\rho \vec{u}) = r(\rho)$$

å…¶ä¸­ï¼š
- **$\rho(x,t)$**: å¯†åº¦å ´ï¼ˆæ¿ƒåº¦ã€ç¨®ç¾¤æ•¸é‡ç­‰ï¼‰
- **$\vec{u}(x,t)$**: æµå‹•é€Ÿåº¦å ´ï¼ˆç”±ç¥žç¶“ç¶²è·¯ `VelocityNet` å­¸ç¿’ï¼‰
- **$r(\rho)$**: åæ‡‰é€ŸçŽ‡ï¼ˆç”±ç¥žç¶“ç¶²è·¯ `ReactionNet` å­¸ç¿’ï¼‰
- **$\nabla \cdot (\rho \vec{u})$**: å‡¸é‹å‹•é …ï¼ˆè³ªé‡æµçš„æ•£åº¦ï¼‰

### ðŸŸ¡ æœ¬ç¨‹å¼å¯¦ç¾çš„æ–¹ç¨‹ï¼ˆç°¡åŒ–å½¢å¼ï¼‰

$$\rho_t = \Delta \rho + r(\rho)$$

å…¶ä¸­ï¼š
- **$\Delta \rho = \nabla^2 \rho = \frac{\partial^2 \rho}{\partial x^2}$**: æ“´æ•£é …ï¼ˆæ‹‰æ™®æ‹‰æ–¯ç®—å­ï¼‰
- **$r(\rho)$**: åæ‡‰é …

### ðŸ’¡ å…©å€‹æ–¹ç¨‹çš„é—œä¿‚

**å®Œæ•´æ–¹ç¨‹** èˆ‡ **ç°¡åŒ–æ–¹ç¨‹** çš„å€åˆ¥ï¼š

| é … | å®Œæ•´æ–¹ç¨‹ | ç°¡åŒ–æ–¹ç¨‹ | èªªæ˜Ž |
|----|----|------|------|
| æ™‚é–“å°Žæ•¸ | $\rho_t$ | $\rho_t$ | âœ… ç›¸åŒ |
| å‡¸é‹å‹• | $+\nabla \cdot (\rho \vec{u})$ | âŒ ç¼ºå¤± | åœ¨ç¨‹å¼ä¸­é€šéŽ Jacobian éš±å«è™•ç† |
| æ“´æ•£ | âŒ ç¼ºå¤± | $+\Delta \rho$ | âœ… åœ¨ç°¡åŒ–æ–¹ç¨‹ä¸­æ˜Žç¢º |
| åæ‡‰ | $= r(\rho)$ | $+ r(\rho)$ | âœ… ç›¸åŒ |

**é—œéµæ´žå¯Ÿ**ï¼šç¨‹å¼ä½¿ç”¨äº† **Lagrangian æè¿°**ï¼Œå‡¸é‹å‹•çš„æ•ˆæžœé€šéŽå¯†åº¦è®Šæ›å…¬å¼ $\rho = \frac{\rho_0 + R}{J}$ éš±å«åœ°è¢«åŒ…å«äº†ï¼Œæ‰€ä»¥åœ¨ PDE ä¸­ä¸éœ€è¦æ˜Žç¢ºå¯«å‡ºã€‚

### åæ‡‰é …ï¼ˆLogistic åæ‡‰ï¼‰

$$r(\rho) = k^+ \rho - k^- \rho^2$$

ç•¶å‰é…ç½®ï¼š
- **$k^+ = 1.0$**: ç·šæ€§å¢žé•·ä¿‚æ•¸
- **$k^- = 1.0$**: äºŒæ¬¡æŠ‘åˆ¶ä¿‚æ•¸

å¯¦éš›åæ‡‰é …ï¼š
$$r(\rho) = 1.0 \cdot \rho - 1.0 \cdot \rho^2 = \rho - \rho^2 = \rho(1-\rho)$$

**ç‰©ç†å«ç¾©**ï¼š
- ç•¶ $\rho \ll 1$ æ™‚ï¼š$r \approx \rho$ â†’ æŒ‡æ•¸å¢žé•· ðŸ“ˆ
- ç•¶ $\rho = 0.5$ æ™‚ï¼š$r = 0.25$ â†’ å¢žé•·æœ€å¿« âš¡
- ç•¶ $\rho = 1$ æ™‚ï¼š$r = 0$ â†’ é”åˆ°é£½å’Œ ðŸ›‘
- ç•¶ $\rho > 1$ æ™‚ï¼š$r < 0$ â†’ è¡°æ¸› ðŸ“‰

---

## ðŸ”‘ æ ¸å¿ƒæ¦‚å¿µ

### 0. æ–¹ç¨‹çš„å…©ç¨®å½¢å¼å’Œç¨‹å¼çš„å¯¦ç¾

#### å®Œæ•´çš„ä¸»æŽ§æ–¹ç¨‹ï¼ˆä¸€èˆ¬æ•¸å­¸å½¢å¼ï¼‰
$$\rho_t + \nabla \cdot (\rho \vec{u}) = r(\rho)$$

é€™æ˜¯æœ€é€šç”¨çš„å½¢å¼ï¼ŒåŒ…å«ï¼š
- **$\rho_t$**: å¯†åº¦éš¨æ™‚é–“çš„è®ŠåŒ–
- **$\nabla \cdot (\rho \vec{u})$**: å‡¸é‹å‹•é …ï¼ˆæµå‹•å¸¶ä¾†çš„å¯†åº¦è®ŠåŒ–ï¼‰
- **$r(\rho)$**: åæ‡‰é …ï¼ˆåŒ–å­¸/ç”Ÿç‰©åæ‡‰å¸¶ä¾†çš„å¯†åº¦è®ŠåŒ–ï¼‰

#### ç¨‹å¼å¯¦ç¾çš„æ–¹ç¨‹ï¼ˆLagrangian å½¢å¼ï¼‰
$$\rho_t = \Delta \rho + r(\rho)$$

é€™å€‹ç°¡åŒ–å½¢å¼ä¸­ï¼š
- âŒ **æ²’æœ‰æ˜Žé¡¯çš„å‡¸é‹å‹•é …** $\nabla \cdot (\rho \vec{u})$
- âœ… **åŒ…å«æ“´æ•£é …** $\Delta \rho$
- âœ… **åŒ…å«åæ‡‰é …** $r(\rho)$

**ç‚ºä»€éº¼ä¸åŒï¼Ÿ** ç¨‹å¼ä½¿ç”¨äº† **Lagrangian æè¿°**ï¼Œå‡¸é‹å‹•çš„æ•ˆæžœå·²ç¶“é€šéŽä»¥ä¸‹æ©Ÿåˆ¶éš±å«åœ°è™•ç†äº†ï¼š

| æ­¥é©Ÿ | æ©Ÿåˆ¶ | æ•ˆæžœ |
|------|------|------|
| 1. é æ¸¬é€Ÿåº¦ | $u^{n+1} = u_{NN}(\rho)$ | ç¶²è·¯å­¸ç¿’æµå‹• |
| 2. æ›´æ–° Jacobian | $J^{n+1} = J^n + \Delta t(\nabla \cdot u)J^n - ...$ | è¿½è¹¤åº§æ¨™è®Šå½¢ |
| 3. è®Šæ›å¯†åº¦ | $\rho = \frac{\rho_0 + R}{J}$ | åº§æ¨™è®Šå½¢å°Žè‡´å¯†åº¦è®ŠåŒ– |

**çµè«–**ï¼šå‡¸é‹å‹•å·²åœ¨æ­¥é©Ÿ 1-3 ä¸­è™•ç†ï¼Œæ‰€ä»¥ PDE ä¸­ä¸éœ€è¦æ˜Žç¢ºå¯«å‡ºã€‚

### 1. Lagrangian è®Šé‡è®Šæ›

ä½¿ç”¨åƒè€ƒåº§æ¨™ç³» $\bar{x}$ï¼ˆææ–™åº§æ¨™ï¼‰ï¼Œå»ºç«‹è®Šæ›ï¼š

$$x = x(\bar{x}, t)$$

**Jacobian çŸ©é™£**ï¼š

$$J(t, \bar{x}) = \det\left[\frac{\partial x}{\partial \bar{x}}\right]$$

**å¯†åº¦èˆ‡åˆå§‹å¯†åº¦çš„é—œä¿‚**ï¼š

$$\rho = \frac{\rho_0 + R(t)}{J(t)}$$

å…¶ä¸­ï¼š
- **$\rho_0$**: åˆå§‹å¯†åº¦ï¼ˆå›ºå®šï¼‰
- **$R(t)$**: åæ‡‰ç´¯ç©é‡ï¼ˆ$R_t = r(\rho)$ï¼‰
- **$J(t)$**: Jacobian é›…å¯æ¯”çŸ©é™£

### 2. åæ‡‰ç©åˆ†è¿½è¹¤

åæ‡‰é …çš„æ™‚é–“ç©åˆ†ï¼š

$$R^{n+1} = R^n + \Delta t \cdot r^n$$

åˆå§‹æ¢ä»¶ï¼š$R(t=0) = 0$

### 3. Jacobian æ›´æ–°

åœ¨ 1D ä¸­ï¼š

$$J^{n+1} = J^n + \Delta t \left(\frac{\partial u}{\partial x} J^n - u \frac{\partial J}{\partial x}\right)$$

åˆå§‹æ¢ä»¶ï¼š$J(t=0) = 1$

---

## ðŸ§  ç¥žç¶“ç¶²è·¯æž¶æ§‹

### 1. VelocityNetï¼ˆé€Ÿåº¦ç¶²è·¯ï¼‰

**è¼¸å…¥**ï¼š$(x, \rho) \in \mathbb{R}^2$

**è¼¸å‡º**ï¼šé€Ÿåº¦å ´ $u(x, \rho) \in \mathbb{R}$

**æž¶æ§‹**ï¼š
```
Input [2]
  â†“
Linear(2, 32) + Tanh
  â†“
Linear(32, 32) + Tanh
  â†“
Linear(32, 32) + Tanh
  â†“
Linear(32, 1)
Output [1]
```

**ç‰©ç†å«ç¾©**ï¼šé æ¸¬æµå‹•é€Ÿåº¦å ´ $u^{n+1} = u_{NN}(\rho^n)$

### 2. ReactionNetï¼ˆåæ‡‰ç¶²è·¯ï¼‰

**è¼¸å…¥**ï¼š$(x, \rho) \in \mathbb{R}^2$

**è¼¸å‡º**ï¼šåæ‡‰é€ŸçŽ‡ $r(x, \rho) \in \mathbb{R}$

**æž¶æ§‹**ï¼š
```
Input [2]
  â†“
Linear(2, 32) + Tanh
  â†“
Linear(32, 32) + Tanh
  â†“
Linear(32, 32) + Tanh
  â†“
Linear(32, 1)
Output [1]
```

**ç‰©ç†å«ç¾©**ï¼šé æ¸¬åæ‡‰é€ŸçŽ‡ $r^{n+1} = r_{NN}(\rho^n)$

### ç‰¹é»ž
- âœ… ç¨ç«‹çš„åƒæ•¸ï¼ˆå®Œå…¨åˆ†é–‹çš„æ¬Šé‡ï¼‰
- âœ… å„è‡ªç¨ç«‹å„ªåŒ–
- âœ… ç›¸åŒçš„æž¶æ§‹ä½†å­¸ç¿’ä¸åŒçš„ç‰©ç†é‡

---

## â±ï¸ è¨“ç·´æµç¨‹

### åˆå§‹åŒ–ï¼ˆInitializationï¼‰

```
t = 0:
  Ïâ‚€ = initial_condition(x)     # åˆå§‹å¯†åº¦
  Râ‚€ = 0                         # åæ‡‰ç©åˆ†åˆå§‹ç‚ºé›¶
  Jâ‚€ = 1                         # Jacobian åˆå§‹ç‚ºå–®ä½çŸ©é™£
  Ï = (Ïâ‚€ + Râ‚€) / Jâ‚€ = Ïâ‚€
```

### æ™‚é–“å¾ªç’°ï¼ˆTime Marchingï¼‰

å°æ–¼æ¯å€‹ epochï¼Œæ¯å€‹æ™‚é–“æ­¥ $n = 0, 1, 2, \ldots, N_t-1$ï¼š

#### æ­¥é©Ÿ 1ï¸âƒ£ï¼šæº–å‚™ç¶²è·¯è¼¸å…¥
```python
net_input = [x, Ïâ¿]
```
å½¢ç‹€ï¼š`[101, 2]`ï¼ˆ101 å€‹ç©ºé–“é»žï¼Œæ¯é»ž 2 å€‹ç‰¹å¾µï¼‰

#### æ­¥é©Ÿ 2ï¸âƒ£ï¼šé æ¸¬é€Ÿåº¦å ´
```python
u^{n+1} = VelocityNet(net_input)
```
è¼¸å‡ºå½¢ç‹€ï¼š`[101, 1]`

#### æ­¥é©Ÿ 3ï¸âƒ£ï¼šé æ¸¬åæ‡‰é€ŸçŽ‡
```python
r^{n+1} = ReactionNet(net_input)
```
è¼¸å‡ºå½¢ç‹€ï¼š`[101, 1]`

#### æ­¥é©Ÿ 4ï¸âƒ£ï¼šæ›´æ–°åæ‡‰ç©åˆ†
```python
R^{n+1} = Râ¿ + Î”t Â· râ¿âºÂ¹
```

#### æ­¥é©Ÿ 5ï¸âƒ£ï¼šè¨ˆç®—é€Ÿåº¦çš„ç©ºé–“å°Žæ•¸
```python
âˆ‚u/âˆ‚x = (u[i+1] - u[i-1]) / (2Â·Î”x)    # ä¸­å¿ƒå·®åˆ†
```

#### æ­¥é©Ÿ 6ï¸âƒ£ï¼šæ›´æ–° Jacobian
```python
J^{n+1} = Jâ¿ + Î”t Â· (âˆ‚u/âˆ‚x Â· Jâ¿ - u Â· âˆ‚J/âˆ‚x)
```

#### æ­¥é©Ÿ 7ï¸âƒ£ï¼šæ›´æ–°å¯†åº¦
```python
Ï^{n+1} = (Ïâ‚€ + R^{n+1}) / J^{n+1}
```

#### æ­¥é©Ÿ 8ï¸âƒ£ï¼šè¨ˆç®—ç©ºé–“å°Žæ•¸ç”¨æ–¼ PDE æ®˜å·®

**äºŒéšŽå°Žæ•¸**ï¼ˆæ“´æ•£é …ï¼‰ï¼š
```python
âˆ‚Â²Ï/âˆ‚xÂ² = (Ï[i+1] - 2Â·Ï[i] + Ï[i-1]) / (Î”x)Â²  # ä¸­å¿ƒå·®åˆ†
```

**ä¸€éšŽå°Žæ•¸**ï¼ˆé‚Šç•Œæ¢ä»¶æª¢æŸ¥ï¼‰ï¼š
```python
âˆ‚Ï/âˆ‚x = (Ï[i+1] - Ï[i-1]) / (2Â·Î”x)  # ä¸­å¿ƒå·®åˆ†
```

#### æ­¥é©Ÿ 9ï¸âƒ£ï¼šè¨ˆç®—æ™‚é–“å°Žæ•¸
```python
Ïâ‚œ = (Ïâ¿âºÂ¹ - Ïâ¿) / Î”t
```

#### æ­¥é©Ÿ ðŸ”Ÿï¼šè¨ˆç®— PDE æ®˜å·®

ç¨‹å¼å¯¦ç¾çš„æ–¹ç¨‹ï¼š
$$\rho_t = \nu \cdot \partial^2\rho/\partial x^2 + r_{NN}(\rho)$$

**æ®˜å·®**ï¼ˆæ‡‰è©²â‰ˆ0ï¼‰ï¼š
$$\text{residual} = \rho_t - \nu \cdot \partial^2\rho/\partial x^2 - r_{NN}$$

ä»£ç¢¼ï¼š
```python
pde_residual = rho_t - nu * d2rho_dx2 - r_next
```

**æ³¨æ„**ï¼šé€™å€‹æ–¹ç¨‹**ä¸åŒ…å«æ˜Žé¡¯çš„å‡¸é‹å‹•é …** $\nabla \cdot (\rho \vec{u})$ï¼Œå› ç‚ºåœ¨ Lagrangian æè¿°ä¸­ï¼Œæµå‹•çš„æ•ˆæžœå·²ç¶“é€šéŽ Jacobian è®Šæ›éš±å«åœ°è¢«è™•ç†äº†ï¼ˆè¦‹æ­¥é©Ÿ 1-6ï¼‰ã€‚å®Œæ•´çš„ç‰©ç†éŽç¨‹æ˜¯ï¼š
- æµå‹•é€šéŽ Jacobian æ›´æ–°å¯†åº¦åæ¨™
- åæ‡‰å’Œæ“´æ•£åœ¨å¯†åº¦æ¼”åŒ–ä¸­è¢«æ˜Žç¢ºè¨ˆç®—

### æå¤±å‡½æ•¸è¨ˆç®—

#### 1. PDE æå¤±
```python
loss_pde = mean((pde_residual)Â²)
```
ç›®æ¨™ï¼šè®“å¯†åº¦æ»¿è¶³ä¸»æŽ§ PDE

#### 2. é‚Šç•Œæ¢ä»¶æå¤±
```python
loss_bc = (âˆ‚Ï/âˆ‚x|â‚“â‚Œâ‚€)Â² + (âˆ‚Ï/âˆ‚x|â‚“â‚Œâ‚)Â²
```
ç›®æ¨™ï¼šé›¶é€šé‡é‚Šç•Œæ¢ä»¶ï¼ˆNeumann BCï¼‰

#### 3. åæ‡‰ä¸€è‡´æ€§æå¤±
```python
loss_reaction = mean((r_NN - (Ï - ÏÂ²))Â²)
```
ç›®æ¨™ï¼šè®“åæ‡‰ç¶²è·¯å­¸ç¿’åˆ°ç²¾ç¢ºçš„åæ‡‰å‹•åŠ›å­¸

#### 4. ç¸½æå¤±
```python
total_loss = w_pde Â· loss_pde + w_bc Â· loss_bc + w_reaction Â· loss_reaction

ç•¶å‰æ¬Šé‡ï¼šw_pde = 1.0, w_bc = 1.0, w_reaction = 1.0
```

### åå‘å‚³æ’­èˆ‡å„ªåŒ–

```python
total_loss.backward()    # è¨ˆç®—æ¢¯åº¦
optimizer.step()         # æ›´æ–°åƒæ•¸ï¼ˆAdam å„ªåŒ–å™¨ï¼‰
```

**å„ªåŒ–å°è±¡**ï¼š
- VelocityNet çš„æ‰€æœ‰åƒæ•¸
- ReactionNet çš„æ‰€æœ‰åƒæ•¸

---

## ðŸ” è©•ä¼°éŽç¨‹

è©•ä¼°æ™‚ï¼Œåœ¨å·²è¨“ç·´çš„ç¶²è·¯ä¸Šé€²è¡Œ **æŽ¨ç†æ¨¡å¼** (inference mode)ï¼š

```
For n = 0, 1, 2, ..., N_t-1:
  1. u^{n+1} = VelocityNet(x, Ïâ¿)  [ç„¡æ¢¯åº¦è¨ˆç®—]
  2. r^{n+1} = ReactionNet(x, Ïâ¿)  [ç„¡æ¢¯åº¦è¨ˆç®—]
  3. æŒ‰ç…§ç›¸åŒçš„æµç¨‹æ›´æ–° R, J, Ï
  4. å„²å­˜çµæžœç”¨æ–¼å¯è¦–åŒ–
```

**è¼¸å‡º**ï¼š
- `rho_numerical_history`: å¯†åº¦å ´æ™‚é–“æ¼”åŒ–
- `u_history`: é€Ÿåº¦å ´æ™‚é–“æ¼”åŒ–
- `r_history`: åæ‡‰é€ŸçŽ‡æ™‚é–“æ¼”åŒ–
- `J_history`: Jacobian æ™‚é–“æ¼”åŒ–

---

## ðŸ“ ä»£ç¢¼çµæ§‹

### æ–‡ä»¶çµ„æˆ

```
rj_net.py (530 è¡Œ)
â”œâ”€ å°Žå…¥å’Œé…ç½® (ç¬¬ 1-40 è¡Œ)
â”œâ”€ ç¥žç¶“ç¶²è·¯é¡žå®šç¾© (ç¬¬ 45-70 è¡Œ)
â”‚  â”œâ”€ VelocityNet
â”‚  â””â”€ ReactionNet
â”œâ”€ è¼”åŠ©å‡½æ•¸ (ç¬¬ 75-95 è¡Œ)
â”‚  â”œâ”€ exact_reaction()
â”‚  â””â”€ initial_condition()
â”œâ”€ è¨“ç·´å‡½æ•¸ (ç¬¬ 100-270 è¡Œ)
â”‚  â””â”€ train_rj_net()
â”œâ”€ è©•ä¼°å‡½æ•¸ (ç¬¬ 275-350 è¡Œ)
â”‚  â””â”€ evaluate_diffusion_reaction()
â”œâ”€ åˆ†æžå‡½æ•¸ (ç¬¬ 355-420 è¡Œ)
â”‚  â””â”€ perform_full_analysis()
â””â”€ ä¸»å‡½æ•¸ (ç¬¬ 425-530 è¡Œ)
   â””â”€ main()
```

### ä¸»è¦å‡½æ•¸

#### `train_rj_net(config, output_dir)`
- **è¼¸å…¥**ï¼šé…ç½®æ–‡ä»¶å­—å…¸ã€è¼¸å‡ºç›®éŒ„è·¯å¾‘
- **è¼¸å‡º**ï¼šè¨“ç·´å¥½çš„ç¶²è·¯ã€æå¤±æ­·å²ã€ç©ºé–“ç¶²æ ¼ã€æ™‚é–“æ­¥ã€è¨­å‚™
- **åŠŸèƒ½**ï¼šåŸ·è¡Œå®Œæ•´çš„è¨“ç·´å¾ªç’°

#### `evaluate_diffusion_reaction(velocity_net, reaction_net, x, time_steps, config, device)`
- **è¼¸å…¥**ï¼šå…©å€‹è¨“ç·´å¥½çš„ç¶²è·¯ã€ç¶²æ ¼åƒæ•¸
- **è¼¸å‡º**ï¼šå¯†åº¦ã€é€Ÿåº¦ã€åæ‡‰é€ŸçŽ‡ã€Jacobian çš„æ™‚é–“åºåˆ—
- **åŠŸèƒ½**ï¼šç”Ÿæˆå®Œæ•´çš„æ•¸å€¼è§£

#### `main()`
- **åŠŸèƒ½**ï¼šå”èª¿æ•´å€‹æµç¨‹
  1. è¼‰å…¥é…ç½®
  2. åŸ·è¡Œè¨“ç·´
  3. åŸ·è¡Œè©•ä¼°
  4. ç”Ÿæˆå¯è¦–åŒ–
  5. å„²å­˜çµæžœ

---

## ðŸ”§ é…ç½®åƒæ•¸

### ç‰©ç†åƒæ•¸ (config.yaml)

```yaml
physics:
  x_min: 0.0        # ç©ºé–“åŸŸä¸‹ç•Œ
  x_max: 1.0        # ç©ºé–“åŸŸä¸Šç•Œ
  t_min: 0.0        # æ™‚é–“åŸŸä¸‹ç•Œ
  t_max: 1.0        # æ™‚é–“åŸŸä¸Šç•Œ
  nx: 101           # ç©ºé–“ç¶²æ ¼é»žæ•¸
  nt: 101           # æ™‚é–“æ­¥æ•¸
  nu: 0.01          # æ“´æ•£ä¿‚æ•¸
  k_plus: 1.0       # åæ‡‰ç·šæ€§é …
  k_minus: 1.0      # åæ‡‰äºŒæ¬¡é …
```

### è¨“ç·´åƒæ•¸

```yaml
training:
  learning_rate: 0.001      # Adam å„ªåŒ–å™¨å­¸ç¿’çŽ‡
  epochs: 2000              # è¨“ç·´ epoch æ•¸
  hidden_size: 32           # ç¶²è·¯éš±è—å±¤å¤§å°
  weight_pde: 1.0           # PDE æå¤±æ¬Šé‡
  weight_bc: 1.0            # é‚Šç•Œæ¢ä»¶æå¤±æ¬Šé‡
  weight_reaction: 1.0      # åæ‡‰æå¤±æ¬Šé‡
```

---

## ðŸ“Š æ•¸å€¼æ–¹æ³•

### æ™‚é–“é›¢æ•£åŒ–

**å‰å‘å·®åˆ†**ï¼ˆä¸€éšŽç²¾åº¦ï¼‰ï¼š
$$\rho_t^n \approx \frac{\rho^{n+1} - \rho^n}{\Delta t}$$

### ç©ºé–“é›¢æ•£åŒ–

**ä¸­å¿ƒå·®åˆ†**ï¼ˆäºŒéšŽç²¾åº¦ï¼‰ï¼š
- ä¸€éšŽå°Žæ•¸ï¼š$\frac{\partial f}{\partial x}\bigg|_i \approx \frac{f_{i+1} - f_{i-1}}{2\Delta x}$
- äºŒéšŽå°Žæ•¸ï¼š$\frac{\partial^2 f}{\partial x^2}\bigg|_i \approx \frac{f_{i+1} - 2f_i + f_{i-1}}{(\Delta x)^2}$

### é‚Šç•Œè™•ç†

åœ¨é‚Šç•Œé»žä½¿ç”¨**å‘å¤–æŽ¨æ¼”**ï¼ˆextrapolationï¼‰ï¼š
```python
f[0] = f[1]           # å·¦é‚Šç•Œ
f[-1] = f[-2]         # å³é‚Šç•Œ
```

---

## ðŸ“ˆ é æœŸçµæžœ

### è¨“ç·´éŽç¨‹
- æå¤±å‡½æ•¸æ‡‰è©²é€æ¼¸ä¸‹é™
- ä¸‰å€‹æå¤±é …éƒ½æ‡‰è©²æ¸›å°

### æœ€çµ‚çµæžœ
- VelocityNet å­¸ç¿’åˆ°é€Ÿåº¦å ´ $u(x, \rho)$ï¼ˆé€šéŽ Jacobian å½±éŸ¿å¯†åº¦æ¼”åŒ–ï¼‰
- ReactionNet å­¸ç¿’åˆ°åæ‡‰é … $r(x, \rho) \approx \rho - \rho^2$
- æ•¸å€¼è§£æ‡‰è©²æ»¿è¶³ PDEï¼š$\rho_t \approx \Delta \rho + r$
- å®Œæ•´ç‰©ç†éŽç¨‹éš±å«åœ°æ»¿è¶³ï¼š$\rho_t + \nabla \cdot (\rho u) = r$ï¼ˆé€šéŽ Lagrangian è®Šæ›ï¼‰

### å¯è¦–åŒ–è¼¸å‡º
- `loss.png`: è¨“ç·´æå¤±æ›²ç·š
- `animation.gif`: æ™‚é–“æ¼”åŒ–å‹•ç•«
- `analysis.png`: è©³ç´°åˆ†æžï¼ˆé€Ÿåº¦ã€åæ‡‰é€ŸçŽ‡ã€è³ªé‡å®ˆæ†ç­‰ï¼‰

---

## ðŸŽ“ é—œéµç‰©ç†æ´žå¯Ÿ

1. **Lagrangian vs Eulerian**
   - **Eulerian**ï¼šå›ºå®šç©ºé–“åæ¨™ï¼Œè¿½è¹¤é€šéŽæ¯å€‹é»žçš„æµå‹•
   - **Lagrangian**ï¼šè·Ÿéš¨ææ–™é‹å‹•ï¼Œè¿½è¹¤æ¯å€‹ç²’å­çš„è»Œè·¡
   - ç¨‹å¼ä½¿ç”¨**Lagrangianæè¿°**ï¼Œå‡¸é‹å‹•éš±å«åœ¨åº§æ¨™è®Šæ›ä¸­

2. **åæ‡‰ç©åˆ†è¿½è¹¤**
   - $R(t)$ ç´¯ç©åæ‡‰çš„æ•ˆæ‡‰
   - å…è¨±éžå®ˆæ†ç³»çµ±ï¼ˆè³ªé‡å¯å‰µå»º/æ¶ˆæ¯€ï¼‰

3. **é›™ç¶²è·¯æž¶æ§‹**
   - é€Ÿåº¦å ´æ±ºå®šæµå‹•ï¼ˆé€šéŽ Jacobian å½±éŸ¿å¯†åº¦åæ¨™ï¼‰
   - åæ‡‰é …æ±ºå®šè³ªé‡ç”Ÿæˆï¼ˆç›´æŽ¥ä½œç”¨æ–¼å¯†åº¦ï¼‰

4. **ç‰©ç†ä¿¡æ¯åŒ–**
   - PDE æ®˜å·®ä½œç‚ºè»Ÿç´„æŸ
   - ç¶²è·¯åœ¨ç‰©ç†ç´„æŸä¸‹å­¸ç¿’
   - å…©å€‹æå¤±é …ï¼ˆåæ‡‰ä¸€è‡´æ€§ + PDEï¼‰å…±åŒå¼•å°Žå­¸ç¿’

5. **ç‚ºä»€éº¼æœ‰å…©å€‹æ–¹ç¨‹è¡¨é”å¼ï¼Ÿ**
   - **å®Œæ•´å½¢å¼** $\rho_t + \nabla \cdot (\rho u) = r$ï¼šç‰©ç†ä¸Šæ›´ç›´è§€
   - **ç°¡åŒ–å½¢å¼** $\rho_t = \Delta \rho + r$ï¼šç¨‹å¼å¯¦ç¾æ™‚æ›´ç°¡æ½”
   - å®ƒå€‘åœ¨ Lagrangian æ¡†æž¶ä¸‹æ˜¯ç­‰åƒ¹çš„

---

## ðŸ’¡ ä½¿ç”¨æŒ‡å—

### é‹è¡Œç¨‹å¼
```bash
cd /home/pon/RJ-net/RJ_net
python rj_net.py --config config.yaml
```

### ä¿®æ”¹åƒæ•¸
ç·¨è¼¯ `config.yaml`ï¼Œé‡æ–°é‹è¡Œå³å¯

### æŸ¥çœ‹çµæžœ
```bash
ls ./results/run_YYYYMMDD_HHMMSS/
# animation.gif
# loss.png
# config_used.yaml
```

---

## ðŸ“ è£œå……èªªæ˜Ž

- **è‡ªå‹•å¾®åˆ†**ï¼šä»£ç¢¼ä½¿ç”¨æœ‰é™å·®åˆ†è€Œéžè‡ªå‹•æ±‚å°Žï¼Œæ›´é«˜æ•ˆç©©å®š
- **GPU æ”¯æŒ**ï¼šä»£ç¢¼è‡ªå‹•æª¢æ¸¬ GPUï¼Œæœ‰å‰‡ä½¿ç”¨
- **é‚Šç•Œæ¢ä»¶**ï¼šä½¿ç”¨ Neumann BCï¼ˆé›¶é€šé‡ï¼‰ï¼Œé©åˆå°é–‰ç³»çµ±
- **æ•¸å€¼ç©©å®šæ€§**ï¼šJacobian é˜²æ­¢é™¤ä»¥é›¶çš„ä¿è­·

