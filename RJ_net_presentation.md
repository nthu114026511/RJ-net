---
marp: true
theme: default
paginate: true
math: katex
style: |
  section {
    font-size: 28px;
  }
  h1 {
    color: #2563eb;
  }
  h2 {
    color: #1e40af;
  }
  code {
    background-color: #f3f4f6;
  }
---

<!-- _class: lead -->
# RJ-net: Reaction-Jacobian Network

**åæ‡‰-æ“´æ•£-å°æµç³»çµ±çš„ç‰©ç†ç¥ç¶“ç¶²è·¯æ±‚è§£å™¨**

*åŸºæ–¼ PINN (Physics-Informed Neural Network) æ–¹æ³•*

---

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

**RJ-net** æ˜¯ä¸€å€‹åŸºæ–¼ç‰©ç†çš„ç¥ç¶“ç¶²è·¯ï¼ˆPINNï¼‰ï¼Œç”¨æ–¼æ±‚è§£åæ‡‰-æ“´æ•£-å°æµç³»çµ±ï¼š

$$\rho_t + \nabla \cdot (\rho u) = \Delta \rho + \sum r_i$$

**æ¸¬è©¦å•é¡Œï¼šFisher-KPP æ–¹ç¨‹**
$$\rho_t = \Delta \rho + k^+ \rho - k^- \rho^2$$

å…¶ä¸­ $k^+ \rho - k^- \rho^2$ æ˜¯ logistic åæ‡‰é …

---

## ğŸ¯ æ ¸å¿ƒæ–¹æ³•

RJ-net ä½¿ç”¨ä»¥ä¸‹è€¦åˆæ–¹ç¨‹çµ„é€²è¡Œæ™‚é–“æ¨é€²ï¼š

1. **å¯†åº¦æ›´æ–°**: $\rho^{n+1} = \frac{\rho_0 + R^{n+1}}{J^{n+1}}$

2. **é€Ÿåº¦å ´**: $u^{n+1} = u_{NN}(\rho^n)$

3. **åæ‡‰ç‡**: $r^{n+1} = r_{NN}(\rho^n)$

4. **åæ‡‰ç´¯ç©**: $R^{n+1} = R^n + \Delta t \cdot r^n$

5. **Jacobian**: $J^{n+1} = J^n + \Delta t [(\nabla \cdot u)J^n - u \cdot \nabla J]$

---

## âš™ï¸ åˆå§‹è¨­ç½® - ç‰©ç†åƒæ•¸

```yaml
physics:
  x_min: 0.0        # ç©ºé–“ç¯„åœèµ·é»
  x_max: 1.0        # ç©ºé–“ç¯„åœçµ‚é»
  t_min: 0.0        # æ™‚é–“èµ·é»
  t_max: 1.0        # æ™‚é–“çµ‚é»
  nx: 101           # ç©ºé–“ç¶²æ ¼é»æ•¸
  nt: 101           # æ™‚é–“æ­¥æ•¸
  
  # åæ‡‰åƒæ•¸ (Ï_t = Î”Ï + Ï - ÏÂ²)
  k_plus: 1.0       # ç·šæ€§å¢é•·ä¿‚æ•¸
  k_minus: 1.0      # äºŒæ¬¡æŠ‘åˆ¶ä¿‚æ•¸
```

**æ™‚é–“æ­¥é•·**: $\Delta t = \frac{t_{max} - t_{min}}{n_t - 1} = 0.01$

---

## âš™ï¸ åˆå§‹è¨­ç½® - ç¥ç¶“ç¶²è·¯æ¶æ§‹

```yaml
training:
  learning_rate: 0.001
  epochs: 2000
  hidden_size: 32
  
  # æå¤±å‡½æ•¸æ¬Šé‡
  weight_pde: 1.0          # PDE æ®˜å·®é …
  weight_bc: 1.0           # é‚Šç•Œæ¢ä»¶é …
  weight_reaction: 1.0     # åæ‡‰é …
```

**å…©å€‹ç¥ç¶“ç¶²è·¯**:
- **VelocityNet**: $u_{NN}(x, \rho) \to u$ (3å±¤éš±è—å±¤ï¼ŒTanhæ¿€æ´»)
- **ReactionNet**: $r_{NN}(x, \rho) \to r$ (3å±¤éš±è—å±¤ï¼ŒTanhæ¿€æ´»)

---

## ğŸ“Š åˆå§‹æ¢ä»¶

**åˆå§‹å¯†åº¦åˆ†å¸ƒ**:
$$\rho(x, t=0) = 0.5 \times (1 + \sin(2\pi x))$$

é€™æ˜¯ä¸€å€‹åœ¨ $[0, 1]$ å€é–“ä¸Šçš„æ­£å¼¦æ³¢ï¼Œç¯„åœåœ¨ $[0, 1]$ ä¹‹é–“ã€‚

**åˆå§‹ Jacobian**: $J(x, t=0) = 1$

**åˆå§‹åæ‡‰ç´¯ç©**: $R(x, t=0) = 0$

---

## ğŸ”„ ç¨‹å¼æµç¨‹åœ–

```
é–‹å§‹
  â†“
è¼‰å…¥é…ç½®æª” (config.yaml)
  â†“
åˆå§‹åŒ–ç¥ç¶“ç¶²è·¯ (VelocityNet, ReactionNet)
  â†“
å»ºç«‹ç©ºé–“ç¶²æ ¼èˆ‡æ™‚é–“æ­¥
  â†“
è¨“ç·´è¿´åœˆ (2000 epochs) â”€â”€â”€â”€â”
  â”œâ”€ æ™‚é–“æ¨é€² (101æ­¥)      â”‚
  â”‚   â”œâ”€ é æ¸¬ u & r        â”‚
  â”‚   â”œâ”€ æ›´æ–° R, J         â”‚
  â”‚   â”œâ”€ è¨ˆç®—æ–°å¯†åº¦ Ï       â”‚
  â”‚   â””â”€ è¨ˆç®—æå¤±           â”‚
  â”œâ”€ åå‘å‚³æ’­              â”‚
  â””â”€ æ›´æ–°ç¶²è·¯åƒæ•¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
è©•ä¼°æ¨¡å¼ï¼šç”Ÿæˆå®Œæ•´æ™‚é–“åºåˆ—
  â†“
è¦–è¦ºåŒ–èˆ‡åˆ†æ
  â†“
å„²å­˜çµæœ
```

---

## ğŸ“ æå¤±å‡½æ•¸è¨­è¨ˆ

**ç¸½æå¤±å‡½æ•¸**:
$$L_{total} = w_{PDE} \cdot L_{PDE} + w_{BC} \cdot L_{BC} + w_{reaction} \cdot L_{reaction}$$

1. **PDE æ®˜å·®æå¤±**:
   $$L_{PDE} = \sum_{n=0}^{N_t-1} \left\| \frac{\rho^{n+1} - \rho^n}{\Delta t} - \frac{\partial^2 \rho}{\partial x^2} - r_{exact}(\rho) \right\|^2$$

2. **é‚Šç•Œæ¢ä»¶æå¤±** (Neumann BC: $\frac{\partial \rho}{\partial x} = 0$):
   $$L_{BC} = \left|\frac{\partial \rho}{\partial x}\right|_{x=0}^2 + \left|\frac{\partial \rho}{\partial x}\right|_{x=1}^2$$

3. **åæ‡‰é …æå¤±**:
   $$L_{reaction} = \|r_{NN}(\rho) - r_{exact}(\rho)\|^2$$

---

## ğŸ“Š è¨“ç·´çµæœ - æå¤±æ”¶æ–‚

![w:900 center](RJ_net/results/run_20251016_111142/loss.png)

æå¤±å‡½æ•¸åœ¨è¨“ç·´éç¨‹ä¸­ç©©å®šä¸‹é™ï¼Œé¡¯ç¤ºæ¨¡å‹æˆåŠŸå­¸ç¿’ç‰©ç†è¦å¾‹ã€‚

---

## ğŸ¬ æ™‚é–“æ¼”åŒ–å‹•ç•«

![w:800 center](RJ_net/results/run_20251016_111142/animation.gif)

å®Œæ•´æ™‚é–“æ¼”åŒ–éç¨‹ï¼Œå±•ç¤ºå¯†åº¦å ´å¾åˆå§‹æ¢ä»¶é€æ­¥æ¼”åŒ–åˆ°æœ€çµ‚ç©©æ…‹ã€‚

---

## âœ… é—œéµæˆæœ

1. **æº–ç¢ºæ€§**: æ•¸å€¼è§£èˆ‡ç²¾ç¢ºè§£é«˜åº¦å»åˆ
2. **æ”¶æ–‚æ€§**: æå¤±å‡½æ•¸ç©©å®šä¸‹é™
3. **ç‰©ç†ä¸€è‡´æ€§**: 
   - åæ‡‰é …å­¸ç¿’æº–ç¢º
   - è³ªé‡åŸºæœ¬å®ˆæ†
   - æ»¿è¶³é‚Šç•Œæ¢ä»¶
4. **ç©©å®šæ€§**: æ™‚é–“æ¨é€²éç¨‹ç©©å®š

**è³ªé‡å®ˆæ†æª¢é©—**:
- $M(0) \approx M(T)$
- ç›¸å°è®ŠåŒ– < 1%

---

## ğŸ”¬ æŠ€è¡“ç‰¹é»

### å„ªå‹¢
- âœ… ç„¡éœ€å‚³çµ±æœ‰é™å·®åˆ†/æœ‰é™å…ƒç¶²æ ¼
- âœ… è‡ªå‹•å¾®åˆ†è¨ˆç®—æ¢¯åº¦ï¼Œç²¾ç¢ºä¸”é«˜æ•ˆ
- âœ… ç‰©ç†ç´„æŸåµŒå…¥æå¤±å‡½æ•¸
- âœ… å¯æ“´å±•è‡³è¤‡é›œå¹¾ä½•å’Œé«˜ç¶­å•é¡Œ

### æ‡‰ç”¨å ´æ™¯
- åæ‡‰-æ“´æ•£ç³»çµ±ï¼ˆåŒ–å­¸åæ‡‰ã€ç”Ÿæ…‹æ¨¡å‹ï¼‰
- æµé«”åŠ›å­¸ï¼ˆå°æµ-æ“´æ•£æ–¹ç¨‹ï¼‰
- ç†±å‚³å°èˆ‡ç‰©è³ªè¼¸é‹
- ç”Ÿç‰©é†«å­¸ï¼ˆè…«ç˜¤ç”Ÿé•·æ¨¡å‹ï¼‰

---

## ğŸ“ è¼¸å‡ºæª”æ¡ˆçµæ§‹

```
results/run_20251016_111142/
â”œâ”€â”€ config_used.yaml      # ä½¿ç”¨çš„é…ç½®åƒæ•¸
â”œâ”€â”€ loss.png              # è¨“ç·´æå¤±æ¼”åŒ–åœ–
â”œâ”€â”€ comparison.png        # åˆå§‹vsæœ€çµ‚ç‹€æ…‹æ¯”è¼ƒ
â”œâ”€â”€ analysis.png          # è©³ç´°åˆ†æï¼ˆé€Ÿåº¦ã€åæ‡‰ã€è³ªé‡ï¼‰
â””â”€â”€ animation.gif         # æ™‚é–“æ¼”åŒ–å‹•ç•«
```

æ‰€æœ‰çµæœè‡ªå‹•ä¿å­˜ï¼Œä¾¿æ–¼å¾ŒçºŒåˆ†æå’Œå ±å‘Šã€‚

---

## ğŸš€ æœªä¾†æ”¹é€²æ–¹å‘

1. **å¤šç¶­æ“´å±•**: æ“´å±•è‡³2D/3Dç©ºé–“
2. **è¤‡é›œåæ‡‰**: å¼•å…¥å¤šçµ„åˆ†åæ‡‰ç³»çµ±
3. **è‡ªé©æ‡‰ç¶²æ ¼**: å‹•æ…‹èª¿æ•´ç©ºé–“è§£æåº¦
4. **ä¸ç¢ºå®šæ€§é‡åŒ–**: å¼•å…¥è²è‘‰æ–¯ç¥ç¶“ç¶²è·¯
5. **åŠ é€Ÿè¨“ç·´**: ä½¿ç”¨æ›´å¤§çš„ç¶²è·¯å’ŒGPUä¸¦è¡Œ
6. **å¯¦é©—æ•¸æ“šæ•´åˆ**: çµåˆå¯¦é©—è§€æ¸¬æ•¸æ“šé€²è¡Œè¨“ç·´

---

<!-- _class: lead -->
# æ„Ÿè¬è†è½ï¼

## Questions?

**GitHub Repository**: RJ-net
**Contact**: nthu114026511

*åŸºæ–¼ç‰©ç†çš„æ·±åº¦å­¸ç¿’ Â· ç§‘å­¸è¨ˆç®—çš„æœªä¾†*

